# TaskStream (Backend)

**TaskStream** ‚Äî —ç—Ç–æ **–±—ç–∫–µ–Ω–¥-—á–∞—Å—Ç—å** –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –Ω–∞ —Å—Ç–µ–∫–µ .NET. –ü—Ä–æ–µ–∫—Ç —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥) –≤ –¥–∞–Ω–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.**

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω —Å —Ü–µ–ª—å—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º:

- **`ApiGateway`**: –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö REST-–∑–∞–ø—Ä–æ—Å–æ–≤. –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ JWT –∏ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç REST-–∑–∞–ø—Ä–æ—Å—ã –≤ gRPC-–≤—ã–∑–æ–≤—ã –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.
- **`Auth.API`**: gRPC-—Å–µ—Ä–≤–∏—Å, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `PostgreSQL` –∏ `Redis`.
- **`Tasks.API`**: gRPC-—Å–µ—Ä–≤–∏—Å, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –ª–æ–≥–∏–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –∏ –∑–∞–¥–∞—á–∞–º–∏ (CRUD). –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
- **`Logging.Worker`**: –§–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å (Worker Service), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏–∑ `RabbitMQ` –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ `MongoDB` –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏–π.

–ö–∞–∂–¥—ã–π –±–∏–∑–Ω–µ—Å-—Å–µ—Ä–≤–∏—Å (`Auth.API`, `Tasks.API`) –≤–Ω—É—Ç—Ä–∏ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ **–ß–∏—Å—Ç–æ–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: .NET 9, ASP.NET Core
- **–¢–∏–ø—ã API**:
  - –í–Ω–µ—à–Ω–∏–π: REST
  - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π: gRPC
- **–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π**: RabbitMQ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤ `Logging.Worker`)
- **–•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö**:
  - PostgreSQL (–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∑–∞–¥–∞—á)
  - Redis (–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è refresh-—Ç–æ–∫–µ–Ω–æ–≤)
  - MongoDB (–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ —Å–æ–±—ã—Ç–∏–π)
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT (Access + Refresh Tokens)
- **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: Docker, Docker Compose
- **Reverse Proxy**: Nginx

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–∞ –∑–∞–ø—É—Å–∫–∞.

### 1. –†–µ–∂–∏–º –≥–∏–±—Ä–∏–¥–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ Docker)

–≠—Ç–æ—Ç —Ä–µ–∂–∏–º –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏ –∫–æ–¥–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ Visual Studio —Å –ø—Ä—è–º—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ñ–∞–π–ª:** `docker-compose.infra.yml`

**–î–µ–π—Å—Ç–≤–∏—è:**

1.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
    ```bash
    docker-compose -f docker-compose.infra.yml up -d --build
    ```
2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:**

    - –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ—à–µ–Ω–∏–µ `TaskStream.sln` –≤ Visual Studio.
    - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (`Auth.API`, `Tasks.API`, `ApiGateway` –∏ `Logging.Worker`).
    - –ù–∞–∂–º–∏—Ç–µ `F5` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å –æ—Ç–ª–∞–¥–∫–æ–π.

3.  **–î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:**
    - `ApiGateway` (REST) Swagger UI -> `https://localhost:7291/` (–ø–æ—Ä—Ç –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è, —Å–º. `launchSettings.json`).
    - `Auth.API` (–ø—Ä—è–º–æ–π gRPC) -> `https://localhost:7168`.
    - `Tasks.API` (–ø—Ä—è–º–æ–π gRPC) -> `https://localhost:7036`.

### 2. –†–µ–∂–∏–º –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏

–≠—Ç–æ—Ç —Ä–µ–∂–∏–º –∑–∞–ø—É—Å–∫–∞–µ—Ç **–≤—Å—é —Å–∏—Å—Ç–µ–º—É** (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –≤—Å–µ .NET-—Å–µ—Ä–≤–∏—Å—ã) –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `Nginx`.

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ñ–∞–π–ª:** `docker-compose.yml`

**–î–µ–π—Å—Ç–≤–∏—è:**

1.  **–°–æ–∑–¥–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** –¥–ª—è Nginx (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω):
    ```bash
    openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout ./nginx/certs/localhost.key -out ./nginx/certs/localhost.crt -subj "/CN=localhost"
    ```
2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å—é —Å–∏—Å—Ç–µ–º—É:**
    ```bash
    docker-compose up -d --build
    ```
3.  **API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ Nginx:**
    - `https://localhost` (Swagger UI –Ω–∞ `ApiGateway`)
